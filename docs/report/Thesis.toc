\contentsline {chapter}{Abstract}{ii}{dummy.1}
\vspace {1em}
\contentsline {chapter}{Acknowledgements}{iii}{dummy.2}
\vspace {1em}
\contentsline {chapter}{List of Figures}{x}{dummy.4}
\contentsline {chapter}{List of Tables}{xi}{dummy.6}
\contentsline {chapter}{Abbreviations}{xii}{dummy.8}
\contentsline {chapter}{\numberline {1}Introduction}{1}{chapter.11}
\contentsline {section}{\numberline {1.1}What it's about}{1}{section.12}
\contentsline {section}{\numberline {1.2}Goals and Intentions}{1}{section.13}
\contentsline {section}{\numberline {1.3}Project Summary}{2}{section.14}
\contentsline {section}{\numberline {1.4}Other Information}{3}{section.19}
\contentsline {subsection}{\numberline {1.4.1}A note on openness}{3}{subsection.25}
\contentsline {subsection}{\numberline {1.4.2}Project Repository}{4}{subsection.26}
\contentsline {chapter}{\numberline {2}Cryptographic Primitives}{5}{chapter.27}
\contentsline {section}{\numberline {2.1}Basics of Information Security}{5}{section.28}
\contentsline {section}{\numberline {2.2}Objectives}{6}{section.30}
\contentsline {section}{\numberline {2.3}Key Concepts}{7}{section.35}
\contentsline {section}{\numberline {2.4}Primitives}{7}{section.36}
\contentsline {subsection}{\numberline {2.4.1}Encryption}{7}{subsection.37}
\contentsline {subsubsection}{\numberline {2.4.1.1}Symmetric Key Encryption}{7}{subsubsection.38}
\contentsline {subsection}{\numberline {2.4.2}Key Agreement}{8}{subsection.39}
\contentsline {subsubsection}{\numberline {2.4.2.1}Key Distribution Centre}{8}{subsubsection.40}
\contentsline {subsubsection}{\numberline {2.4.2.2}Asymmetric Cryptography}{9}{subsubsection.46}
\contentsline {subsection}{\numberline {2.4.3}Authentication}{10}{subsection.51}
\contentsline {subsection}{\numberline {2.4.4}Digital Signatures}{10}{subsection.54}
\contentsline {subsection}{\numberline {2.4.5}Public-key Certificates}{11}{subsection.58}
\contentsline {subsection}{\numberline {2.4.6}Hashing}{12}{subsection.63}
\contentsline {section}{\numberline {2.5}Mathematics}{13}{section.66}
\contentsline {subsection}{\numberline {2.5.1}Notation}{13}{subsection.67}
\contentsline {subsection}{\numberline {2.5.2}Number Theory}{13}{subsection.78}
\contentsline {subsubsection}{\numberline {2.5.2.1}Modulo Arithmetic}{14}{subsubsection.94}
\contentsline {subsection}{\numberline {2.5.3}Abstract Algebra}{15}{subsection.100}
\contentsline {subsection}{\numberline {2.5.4}Complexity}{15}{subsection.101}
\contentsline {section}{\numberline {2.6}Moving On}{15}{section.103}
\contentsline {chapter}{\numberline {3}Number Theory and Public-key Cryptography}{16}{chapter.104}
\contentsline {section}{\numberline {3.1}Overview}{16}{section.105}
\contentsline {section}{\numberline {3.2}Modular Arithmetic and Congruence}{17}{section.106}
\contentsline {section}{\numberline {3.3}Prime Numbers}{17}{section.107}
\contentsline {subsection}{\numberline {3.3.1}Generation}{18}{subsection.109}
\contentsline {subsubsection}{\numberline {3.3.1.1}Probable, Provable and Pseudo-primes}{18}{subsubsection.114}
\contentsline {paragraph}{Probable Primes}{18}{section*.115}
\contentsline {paragraph}{Pseudo-primes}{19}{section*.116}
\contentsline {paragraph}{Provable Primes}{19}{section*.117}
\contentsline {subsubsection}{\numberline {3.3.1.2}Sieves}{19}{subsubsection.118}
\contentsline {subsubsection}{\numberline {3.3.1.3}Fermat's Little Theorem}{19}{subsubsection.119}
\contentsline {subsubsection}{\numberline {3.3.1.4}Miller--Rabin Primality Test}{21}{subsubsection.148}
\contentsline {subsubsection}{\numberline {3.3.1.5}Solovay--Strassen Primality Test}{23}{subsubsection.208}
\contentsline {subsubsection}{\numberline {3.3.1.6}Lehmann Primality Test}{26}{subsubsection.281}
\contentsline {subsubsection}{\numberline {3.3.1.7}AKS Primality Test}{27}{subsubsection.310}
\contentsline {subsubsection}{\numberline {3.3.1.8}Maurer's Algorithm}{28}{subsubsection.323}
\contentsline {paragraph}{Trial Division}{29}{section*.326}
\contentsline {paragraph}{Algorithm Steps}{29}{section*.340}
\contentsline {subsubsection}{\numberline {3.3.1.9}BigInteger Generation}{29}{subsubsection.342}
\contentsline {subsubsection}{\numberline {3.3.1.10}Primality Test Outcomes}{30}{subsubsection.343}
\contentsline {paragraph}{Running Times}{30}{section*.348}
\contentsline {paragraph}{Conclusion}{31}{section*.350}
\contentsline {subsubsection}{\numberline {3.3.1.11}A Note on Random Number Generators}{31}{subsubsection.351}
\contentsline {subsection}{\numberline {3.3.2}Strong Primes}{32}{subsection.355}
\contentsline {section}{\numberline {3.4}Integers}{33}{section.359}
\contentsline {subsection}{\numberline {3.4.1}Factorisation}{33}{subsection.360}
\contentsline {section}{\numberline {3.5}Public-key Cryptography}{34}{section.362}
\contentsline {subsection}{\numberline {3.5.1}RSA}{34}{subsection.363}
\contentsline {subsubsection}{\numberline {3.5.1.1}The RSA Problem}{34}{subsubsection.364}
\contentsline {subsubsection}{\numberline {3.5.1.2}RSA}{34}{subsubsection.369}
\contentsline {subsubsection}{\numberline {3.5.1.3}Key Generation}{34}{subsubsection.370}
\contentsline {paragraph}{Key Distribution}{37}{section*.448}
\contentsline {subsubsection}{\numberline {3.5.1.4}Encryption}{37}{subsubsection.449}
\contentsline {subsubsection}{\numberline {3.5.1.5}Decryption}{39}{subsubsection.505}
\contentsline {subsubsection}{\numberline {3.5.1.6}Formal Proof}{40}{subsubsection.561}
\contentsline {subsubsection}{\numberline {3.5.1.7}Textbooks and OAEP}{41}{subsubsection.562}
\contentsline {paragraph}{The Mask Generation Function (MGF)}{43}{section*.574}
\contentsline {subsection}{\numberline {3.5.2}Diffie--Hellman}{52}{subsection.921}
\contentsline {subsubsection}{\numberline {3.5.2.1}Implementation}{53}{subsubsection.928}
\contentsline {section}{\numberline {3.6}Other Variations of Public-key Cryptography}{59}{section.1135}
\contentsline {subsection}{\numberline {3.6.1}ElGamal}{59}{subsection.1136}
\contentsline {paragraph}{Key Generation and Sharing}{59}{section*.1137}
\contentsline {paragraph}{Encryption}{60}{section*.1143}
\contentsline {paragraph}{Decryption}{60}{section*.1148}
\contentsline {subsubsection}{\numberline {3.6.1.1}Textbook Algorithm Insecurity}{60}{subsubsection.1150}
\contentsline {subsection}{\numberline {3.6.2}Rabin}{61}{subsection.1151}
\contentsline {paragraph}{Key Generation}{61}{section*.1152}
\contentsline {paragraph}{Encryption}{61}{section*.1157}
\contentsline {paragraph}{Decryption}{61}{section*.1159}
\contentsline {section}{\numberline {3.7}Uses and going forward}{61}{section.1161}
\contentsline {subsection}{\numberline {3.7.1}Problems}{63}{subsection.1162}
\contentsline {chapter}{\numberline {4}Symmetric Cryptography}{65}{chapter.1171}
\contentsline {chapter}{\numberline {5}Identification and Authentication}{66}{chapter.1172}
\contentsline {section}{\numberline {5.1}Overview and Intentions}{66}{section.1173}
\contentsline {section}{\numberline {5.2}Basic and Common Schemes}{66}{section.1174}
\contentsline {section}{\numberline {5.3}Digital Signatures}{66}{section.1175}
\contentsline {section}{\numberline {5.4}Certificates}{66}{section.1176}
\contentsline {section}{\numberline {5.5}Other Methods}{66}{section.1177}
\contentsline {chapter}{\numberline {6}Enigma: A Testbed}{67}{chapter.1178}
\contentsline {section}{\numberline {6.1}Overview and Intentions}{67}{section.1179}
\contentsline {section}{\numberline {6.2}Engineering Methodologies and Planning}{67}{section.1180}
\contentsline {subsection}{\numberline {6.2.1}Methodology}{67}{subsection.1181}
\contentsline {subsection}{\numberline {6.2.2}Documentation}{68}{subsection.1182}
\contentsline {section}{\numberline {6.3}Application Development}{69}{section.1184}
\contentsline {subsection}{\numberline {6.3.1}User Interface}{69}{subsection.1185}
\contentsline {subsubsection}{\numberline {6.3.1.1}GUI Frameworks}{69}{subsubsection.1186}
\contentsline {paragraph}{SWT}{69}{section*.1187}
\contentsline {subsubsection}{\numberline {6.3.1.2}Designs}{70}{subsubsection.1188}
\contentsline {subsubsection}{\numberline {6.3.1.3}Connect Window}{72}{subsubsection.1194}
\contentsline {subsubsection}{\numberline {6.3.1.4}Chat Window}{74}{subsubsection.1250}
\contentsline {paragraph}{The display of messages}{75}{section*.1259}
\contentsline {paragraph}{Sending messages}{76}{section*.1271}
\contentsline {subsubsection}{\numberline {6.3.1.5}Log Window}{76}{subsubsection.1272}
\contentsline {subsubsection}{\numberline {6.3.1.6}Preferences Window}{77}{subsubsection.1274}
\contentsline {subsection}{\numberline {6.3.2}Preferences}{78}{subsection.1279}
\contentsline {subsubsection}{\numberline {6.3.2.1}Usage}{80}{subsubsection.1318}
\contentsline {subsection}{\numberline {6.3.3}Internationalisation}{80}{subsection.1323}
\contentsline {subsection}{\numberline {6.3.4}Drawable Graphics}{82}{subsection.1381}
\contentsline {section}{\numberline {6.4}Protocol Implementation}{83}{section.1408}
\contentsline {subsection}{\numberline {6.4.1}Overview}{83}{subsection.1409}
\contentsline {subsubsection}{\numberline {6.4.1.1}Goals and Objectives}{84}{subsubsection.1410}
\contentsline {subsection}{\numberline {6.4.2}Server Design}{84}{subsection.1414}
\contentsline {subsubsection}{\numberline {6.4.2.1}Server}{84}{subsubsection.1415}
\contentsline {subsubsection}{\numberline {6.4.2.2}Session}{85}{subsubsection.1421}
\contentsline {subsection}{\numberline {6.4.3}Protocol Model}{86}{subsection.1422}
\contentsline {subsubsection}{\numberline {6.4.3.1}Routing and How It Works}{86}{subsubsection.1423}
\contentsline {subsection}{\numberline {6.4.4}Parsing XML}{87}{subsection.1425}
\contentsline {subsubsection}{\numberline {6.4.4.1}SAX and Xerces}{87}{subsubsection.1426}
\contentsline {paragraph}{The InputHandler}{88}{section*.1430}
\contentsline {subsubsection}{\numberline {6.4.4.2}Packets}{90}{subsubsection.1483}
\contentsline {subsubsection}{\numberline {6.4.4.3}Packet Handling}{92}{subsubsection.1487}
\contentsline {paragraph}{The PacketQueue}{92}{section*.1488}
\contentsline {paragraph}{The PacketListener}{92}{section*.1489}
\contentsline {paragraph}{The QueueThread}{92}{section*.1490}
\contentsline {paragraph}{The ProcessThread}{93}{section*.1518}
\contentsline {subsubsection}{\numberline {6.4.4.4}Handlers}{94}{subsubsection.1519}
\contentsline {subsection}{\numberline {6.4.5}Fitting the Protocol Components Together}{94}{subsection.1524}
\contentsline {section}{\numberline {6.5}Algorithm Implementation}{95}{section.1525}
\contentsline {subsection}{\numberline {6.5.1}Interfaces and Abstraction}{95}{subsection.1526}
\contentsline {subsection}{\numberline {6.5.2}Key Agreement and Certficates}{96}{subsection.1527}
\contentsline {paragraph}{Key Generation}{96}{section*.1528}
\contentsline {subsection}{\numberline {6.5.3}Ciphers}{97}{subsection.1529}
\contentsline {paragraph}{Sending a message}{97}{section*.1530}
\contentsline {paragraph}{Receiving a message}{97}{section*.1540}
\contentsline {section}{\numberline {6.6}Summary}{98}{section.1552}
\contentsline {section}{\numberline {6.7}Usage}{98}{section.1553}
\contentsline {section}{\numberline {6.8}Program Listing}{98}{section.1554}
\contentsline {chapter}{\numberline {7}Cryptanalysis}{99}{chapter.1555}
\contentsline {section}{\numberline {7.1}Public-key Cryptography}{99}{section.1556}
\contentsline {subsection}{\numberline {7.1.1}RSA}{99}{subsection.1557}
\contentsline {subsubsection}{\numberline {7.1.1.1}Brute Force}{99}{subsubsection.1558}
\contentsline {subsubsection}{\numberline {7.1.1.2}Elementary Attacks}{100}{subsubsection.1559}
\contentsline {paragraph}{Small Exponent}{100}{section*.1560}
\contentsline {subparagraph}{Private Exponent}{100}{section*.1561}
\contentsline {subparagraph}{Public Exponent}{100}{section*.1562}
\contentsline {paragraph}{Key Exposure}{101}{section*.1563}
\contentsline {paragraph}{Coppersmith's Short Pad Attack}{101}{section*.1564}
\contentsline {subparagraph}{Hastad's Broadcast Attack}{101}{section*.1565}
\contentsline {paragraph}{Related Message Attack}{101}{section*.1566}
\contentsline {paragraph}{Forward Search Attack}{101}{section*.1567}
\contentsline {paragraph}{Common Modulus Attack}{101}{section*.1568}
\contentsline {paragraph}{Cycling Attack}{101}{section*.1569}
\contentsline {paragraph}{Message Concealing}{101}{section*.1570}
\contentsline {subsubsection}{\numberline {7.1.1.3}System and Implementation Attacks}{101}{subsubsection.1571}
\contentsline {paragraph}{Timing}{101}{section*.1572}
\contentsline {paragraph}{Random Faults}{101}{section*.1573}
\contentsline {paragraph}{Bleichenbacher's Attack}{102}{section*.1574}
\contentsline {subsection}{\numberline {7.1.2}Certificates and Authentication}{102}{subsection.1575}
\contentsline {subsubsection}{\numberline {7.1.2.1}Implementation Attacks}{102}{subsubsection.1576}
\contentsline {paragraph}{SSL BEAST}{102}{section*.1577}
\contentsline {paragraph}{Authority Security and Impersonation}{102}{section*.1578}
\contentsline {section}{\numberline {7.2}Symmetric Cryptography}{102}{section.1579}
\contentsline {subsection}{\numberline {7.2.1}Brute-force}{103}{subsection.1580}
\contentsline {subsection}{\numberline {7.2.2}XSL Attack}{103}{subsection.1581}
\contentsline {subsection}{\numberline {7.2.3}Biryukov and Khovratovich}{103}{subsection.1582}
\contentsline {subsection}{\numberline {7.2.4}Related Key Attack}{103}{subsection.1583}
\contentsline {subsection}{\numberline {7.2.5}Known-key Distinguishing Attack}{103}{subsection.1584}
\contentsline {subsection}{\numberline {7.2.6}Bogdanov, Khovratovich, and Rechberger}{103}{subsection.1585}
\contentsline {subsection}{\numberline {7.2.7}Side-channel attacks}{103}{subsection.1586}
\contentsline {section}{\numberline {7.3}Hash Functions}{103}{section.1587}
\contentsline {subsection}{\numberline {7.3.1}Birthday Attacks}{103}{subsection.1588}
\contentsline {subsection}{\numberline {7.3.2}Collision and Compression}{103}{subsection.1589}
\contentsline {subsection}{\numberline {7.3.3}Chaining Attack}{103}{subsection.1590}
\contentsline {section}{\numberline {7.4}Emerging Threats}{103}{section.1591}
\contentsline {subsection}{\numberline {7.4.1}Quantum Cryptography and Cryptanalysis}{103}{subsection.1592}
\contentsline {subsection}{\numberline {7.4.2}Ron was wrong, Whit is right}{104}{subsection.1593}
\contentsline {subsubsection}{\numberline {7.4.2.1}Sony PlayStation 3}{104}{subsubsection.1594}
\contentsline {section}{\numberline {7.5}A comment on theory}{106}{section.1595}
\contentsline {chapter}{\numberline {8}Outcomes and Further Research}{107}{chapter.1596}
\contentsline {section}{\numberline {8.1}Fulfilment of Specification}{107}{section.1597}
\contentsline {section}{\numberline {8.2}Testing}{107}{section.1598}
\contentsline {subsection}{\numberline {8.2.1}Test Driven Development}{107}{subsection.1599}
\contentsline {subsection}{\numberline {8.2.2}Unit Testing}{107}{subsection.1600}
\contentsline {subsection}{\numberline {8.2.3}Code Coverage}{107}{subsection.1601}
\contentsline {subsection}{\numberline {8.2.4}Functional Testing}{107}{subsection.1602}
\contentsline {section}{\numberline {8.3}Problems and Evaluation}{108}{section.1603}
\contentsline {section}{\numberline {8.4}Limitations}{108}{section.1604}
\contentsline {subsection}{\numberline {8.4.1}Standards Compliance}{108}{subsection.1605}
\contentsline {subsection}{\numberline {8.4.2}Hardware Implementation}{108}{subsection.1606}
\contentsline {section}{\numberline {8.5}Summary}{108}{section.1607}
\vspace {2em}
\contentsline {chapter}{\numberline {A}Enigma Application Software Requirements Specification}{109}{appendix.1608}
\contentsline {section}{\numberline {A.1}Introduction}{109}{section.1609}
\contentsline {subsection}{\numberline {A.1.1}Scope}{109}{subsection.1610}
\contentsline {section}{\numberline {A.2}Overall Description}{109}{section.1611}
\contentsline {subsection}{\numberline {A.2.1}Product Functions}{110}{subsection.1612}
\contentsline {subsubsection}{\numberline {A.2.1.1}Primary Functions}{110}{subsubsection.1613}
\contentsline {subsection}{\numberline {A.2.2}Interfaces and Accessibility}{110}{subsection.1614}
\contentsline {subsection}{\numberline {A.2.3}User Characteristics}{110}{subsection.1615}
\contentsline {subsection}{\numberline {A.2.4}Constraints}{111}{subsection.1616}
\contentsline {subsection}{\numberline {A.2.5}Assumptions and dependencies}{111}{subsection.1617}
\contentsline {chapter}{\numberline {B}Enigma Protocol Specification}{112}{appendix.1618}
\contentsline {section}{\numberline {B.1}Introduction}{112}{section.1619}
\contentsline {section}{\numberline {B.2}Requirements}{112}{section.1621}
\contentsline {section}{\numberline {B.3}History}{113}{section.1625}
\contentsline {section}{\numberline {B.4}Terminology}{113}{section.1626}
\contentsline {section}{\numberline {B.5}Format}{113}{section.1627}
\contentsline {section}{\numberline {B.6}Commands}{114}{section.1628}
\contentsline {subsection}{\numberline {B.6.1}Connection}{114}{subsection.1629}
\contentsline {subsection}{\numberline {B.6.2}Authentication}{114}{subsection.1630}
\contentsline {subsection}{\numberline {B.6.3}Messaging}{115}{subsection.1631}
\contentsline {subsection}{\numberline {B.6.4}Errors}{115}{subsection.1632}
\contentsline {chapter}{\numberline {C}Licenced Software Usage}{117}{appendix.1633}
\contentsline {chapter}{\numberline {D}Enigma: User Manual}{119}{appendix.1638}
\contentsline {section}{\numberline {D.1}Introduction}{119}{section.1639}
\contentsline {section}{\numberline {D.2}Installation}{119}{section.1640}
\contentsline {section}{\numberline {D.3}Connecting and Sending Messages}{119}{section.1641}
\contentsline {section}{\numberline {D.4}Cryptosystems}{119}{section.1642}
\contentsline {subsection}{\numberline {D.4.1}Generating Keys}{119}{subsection.1643}
\contentsline {subsection}{\numberline {D.4.2}Notes on Maintaining Secrecy}{119}{subsection.1644}
\contentsline {section}{\numberline {D.5}Troubleshooting}{119}{section.1645}
\vspace {2em}
\contentsline {chapter}{Bibliography}{120}{dummy.1646}
