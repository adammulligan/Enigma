package com.cyanoryx.uni.crypto.cert;

import java.io.File;
import java.io.FileNotFoundException;
import java.io.IOException;
import java.util.Calendar;
import java.util.GregorianCalendar;
import java.util.zip.DataFormatException;

import com.cyanoryx.uni.crypto.rsa.PrivateKey;
import com.cyanoryx.uni.crypto.rsa.PublicKey;

public class GenerateCertificate {
	public static void main(String[] args) {
		/*String key = "110081981297385362878340022068444912393731027211254093062543818109411585872711238216734514331620444461237972730456835782830867225700112767750842612493243736108579031329223201586917198156872185441940884106411354149273597730642607526597384736738545731874313581284462945129954777033783605324178820716438200029803,12444459590836228911254751112818057893007051697109484615297765390621853418144095540952019262112015033475670147423253956756580355698909277073583985903485933";
		String ca_key     ="142016567254690874847663293326471300968622578738112218200968053477526014024608715421537127214520917069686731584227641274297773162777842828262120028746693691182210640277869484027102527106665810236715545398171502799685095991153552092316728498643411364923734660721851372458708630133417780395513039034054035709537,11905201990208331569063202504275845594065275310114536550667965474851522576115410429104764637658718584430251990912422093127298831857975975971685128024533577";
		String ca_key_priv="142016567254690874847663293326471300968622578738112218200968053477526014024608715421537127214520917069686731584227641274297773162777842828262120028746693691182210640277869484027102527106665810236715545398171502799685095991153552092316728498643411364923734660721851372458708630133417780395513039034054035709537,8788673090677859770098422053308846885611527554186553972438804601015028284962293778598589666659123424432810909831903955083597228875369983417305304460714733839895597072243209942503347731265567154666775973476535453877843887286676353954734737271900825031363276101748822987657534182298965772309598396117833226233";
		
		CertificateAuthority ca = new CertificateAuthority(new PublicKey(ca_key),new PrivateKey(ca_key_priv));
		Certificate c;
		try {
			c = ca.generate(new byte[]{1,2,3},
										  new PublicKey(key),
										  key.getBytes(),
										  "Adam Mulligan",
										  Calendar.getInstance(),
										  new GregorianCalendar(2015, 01, 01));
			System.out.println(c);
		} catch (Exception e) {
			e.printStackTrace();
		}*/
		
		try {
			Certificate c = new Certificate(new File("./cert"));
			System.out.println(new String(c.getSubject_key()));
		} catch (FileNotFoundException e) {
			// TODO Auto-generated catch block
			e.printStackTrace();
		} catch (IOException e) {
			// TODO Auto-generated catch block
			e.printStackTrace();
		} catch (DataFormatException e) {
			// TODO Auto-generated catch block
			e.printStackTrace();
		}
	}
}
