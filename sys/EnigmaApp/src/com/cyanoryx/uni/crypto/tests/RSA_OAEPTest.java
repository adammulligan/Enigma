package com.cyanoryx.uni.crypto.tests;

import static org.junit.Assert.assertEquals;
import static org.junit.Assert.fail;

import org.junit.Test;

import com.cyanoryx.uni.crypto.rsa.PrivateKey;
import com.cyanoryx.uni.crypto.rsa.PublicKey;
import com.cyanoryx.uni.crypto.rsa.RSA_OAEP;

/**
 * @author adammulligan
 *
 */
public class RSA_OAEPTest {
	private static final String priv_key = "97908641078640930921736814310768510169502199796540754915214684247300747919562440908414882982666267234675634624391750121205729378296088906136484545824406901044989912240745561106305589497728821662373449331189470736784196308691312398052928834112802969084310659180027756305383717330585077927678442791114372333499,52432324881898603285934453279092473437598734248871767260561027537857905416373755842004854726294620909499244683507853076198112186232119788935031555229778245734784872595539263601969251470153229916788111627980338410491882000269569812439373576317795386683716860495889662676826175759042603312482246250867029145927";
	private static final String pub_key  = "97908641078640930921736814310768510169502199796540754915214684247300747919562440908414882982666267234675634624391750121205729378296088906136484545824406901044989912240745561106305589497728821662373449331189470736784196308691312398052928834112802969084310659180027756305383717330585077927678442791114372333499,8619173693953199559175251658622572787045842450473181805478558316459616765391923302339800479316421945670844719599928574812822832312762299815792896841142231";

	private static final String test_message = "The quick brown fox jumps over the lazy dog.";
	
	@Test
	public void test() {
		try {
			RSA_OAEP rsa_enc = new RSA_OAEP(new PublicKey(RSA_OAEPTest.pub_key));
			byte[] ciphertext = rsa_enc.encrypt(RSA_OAEPTest.test_message.getBytes());
			
			RSA_OAEP rsa_dec = new RSA_OAEP(new PrivateKey(RSA_OAEPTest.priv_key));
			byte[] plaintext = rsa_dec.decrypt(ciphertext);
			
			assertEquals("Test decrypted ciphertext matches original",
					     new String(plaintext),
					     RSA_OAEPTest.test_message);
		} catch (Exception e) {
			fail(e.getMessage());
			e.printStackTrace();
		}
	}

}
